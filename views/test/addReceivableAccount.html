
<body>
<div class="x-body">
    <!--<div class="list1">-->
        <!--&lt;!&ndash;<button class="rf layui-btn" data-method="add" id="add">新增白菜</button>&ndash;&gt;-->
    <!--</div>-->
    <div class="layui-col-xs4">
        <div class="layui-input-inline">
            <input type="text" class="layui-input" placeholder="开始日期" id="startTime">
        </div>
        <div class="layui-input-inline">
            <input type="text" class="layui-input" placeholder="结束日期" id="endTime">
        </div>
        <div class="layui-btn" style="margin-left:-4px;" data-type="search" id="search">查询</div>
    </div>
    <div class="layui-inline layui-col-xs1 layui-col-xs-offset7">
        <button class="layui-btn " data-method="add" id="add">添加</button>
        <!--<button class="layui-btn " data-method="add" id="add1">添加</button>-->
    </div>

    <table class="layui-table" id="moneyPrice"  lay-filter="table1"></table>

</div>
<script type="text/html" id="barmoneyPrice">
    <div id="layerDemo">
        <button class="layui-btn layui-btn-xs" lay-event="revise">修改</button>
        <button class="layui-btn layui-btn-xs layui-btn-danger"  lay-event="del" >删除</button>
    </div>
</script>
<script>
    layui.use(['table','layer','form','laydate'],function () {
        //日期查询
        var laydate = layui.laydate;
        laydate.render({elem:'#startTime'});
        laydate.render({elem:'#endTime'});
        var table = layui.table;
        var $=layui.jquery,layer=layui.layer;
        var form = layui.form;
//table数据渲染
        table.render({
            elem:"#moneyPrice"
            ,url:"/test/t206"
            ,page:true
            ,cols:[[
                {field:'number',title:"序号"}
                ,{field:'ID',title:"账号ID",sort:true}
                ,{field:'accountNum',title:"账号"}
                ,{field:'price',title:"金额"}
                ,{field:'link',title:"拉起链接"}
                ,{field:'',title:"操作",toolbar:'#barmoneyPrice'}
            ]]
        });
        //修改删除功能
        table.on('tool(table1)',function (obj) {
            var data = obj.data;
            if(obj.event==='revise'){
                //获取原数据
                var originalID = data.ID;
                var originalaccountNum = data.accountNum;
                var originalprice = data.price;
                var originallink = data.link;

                layer.open({
                    type:1
                    ,title:'操作'
                    ,closeBtn:1
                    ,area:['60%','60%']
                    ,shade:0.5
                    ,id:"LAY_layuipro"
                    // ,btn:['确认','取消']
                    ,btnAlign:'c'
                    ,moveType:1
                    ,content:$('#revise')
                    // ,content:'revisecurrency'
                    ,success:function (layero,index) {
                        $('#ID').val(originalID);
                        $('#accountNum').val(originalaccountNum);
                        $('#price').val(originalprice);
                        $('#link').val(originallink);
                    }
                })
            }else if(obj.event==='del'){

                layer.open({
                    type:1
                    ,title:'删除'
                    ,closeBtn:1
                    ,area:['30%','30%']
                    //,shade:0.5
                    ,id:"LAY_layuipro"
                    ,btn:['确认','取消']
                    ,btnAlign:'c'
                    ,moveType:1
                    ,content:$('#del')
                    ,success:function (layero,index) {
                        $('#num').html(data.ID);
                    }
                    ,yes:function (index,layero) {
                        table.reload('moneyPrice');
                        layer.close(index);
                    }
                })
            }
        })
        //添加
        var active = {
            add:function () {
                layer.open({
                    type:1
                    ,title:false
                    ,closeBtn:1
                    ,area:['40%','40%']
                    ,id:'LAY_layuipro'
                    // ,btn:['确认','取消']
                    ,content:$('#addcount')

                })
            }
        };

        $('#add').on('click', function(){
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });

        //查询
        var active1 = {
            search: function(){
                var startTime = $('#startTime');
                var endTime = $('#endTime');

                //执行重载
                table.reload('moneyPrice', {
                    url:'/test/t204'
                    ,page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        start_time: startTime.val(),
                        end_time: endTime.val()
                    }
                });
            }
        };
        //查询按钮绑定事件
        $('#search').on('click', function(){
            var type = $(this).data('type');
            active1[type] ? active1[type].call(this) : '';
        });

//排序
        table.on('sort(table1)', function(obj){
            table.reload('moneyPrice', {
                url:'/test/t205',
                initSort: obj
                ,where: {
                    field: obj.field
                    ,order: obj.type
                }
            });
        });


    })
</script>
</body>



<!--添加-->
<div class="x-body" id="addcount" style="display: none;">
    <form action="" class="layui-form" style="margin-top:50px;">
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">账号ID</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="ID" id="ID">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">账号</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="account" id="account">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">金额</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="price" id="price">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">拉起链接</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="link" id="link">
            </div>
        </div>
        <div class="layui-form-item" style="width:100%;">
            <div style="position: absolute;left:40%;margin-bottom: 15px;">
                <button class="layui-btn" lay-submit="" lay-filter="submit">确认</button>
                <button class="layui-btn" type="reset">重置</button>
            </div>
        </div>
    </form>
</div>
<!--修改-->
<div class="x-body" id="revise" style="display: none;">
    <form action="" class="layui-form" style="margin-top:50px;">
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">账号ID</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="ID" id="ID">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">账号</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="account" id="account">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">金额</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="price" id="price">
            </div>
        </div>
        <div class="layui-form-item">
            <label for="" class="layui-form-label" style="width: 20%;">拉起链接</label>
            <div class="layui-input-inline" style="width: 60%;">
                <input type="text" class="layui-input" lay-verify="required" name="link" id="link">
            </div>
        </div>
        <div class="layui-form-item" style="width:100%;">
            <div style="position: absolute;left:40%;margin-bottom: 15px;">
                <button class="layui-btn" lay-submit="" lay-filter="submit">确认</button>
                <button class="layui-btn" type="reset">重置</button>
            </div>
        </div>
    </form>
</div>



<!--删除-->
<div class="x-body" id="del"  style="display: none;text-align: center;padding-top:10%;">
    <h2 class="center">确认删除ID为<span id="num"></span>的收款账号吗？</h2>
</div>
